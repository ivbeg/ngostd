!function(a){var t="data-ab-color",n="data-ab-parent",e="data-ab-css-background",r="ab-color-found",o={selector:'[data-adaptive-background="1"]',parent:null,exclude:["rgb(0,0,0)","rgba(255,255,255)"],normalizeTextColor:!1,normalizedTextColors:{light:"#fff",dark:"#000"},lumaClasses:{light:"ab-light",dark:"ab-dark"},yiqThreshold:"128"};!function(a){"use strict";var t=function(){return document.createElement("canvas").getContext("2d")},n=function(a,n){var e=new Image,r=a.src||a;"data:"!==r.substring(0,5)&&(e.crossOrigin="Anonymous"),e.onload=function(){var a=t("2d");a.drawImage(e,0,0);var r=a.getImageData(0,0,e.width,e.height);n&&n(r.data)},e.src=r},e=function(a){return["rgb(",a,")"].join("")},r=function(a){return a.map(function(a){return e(a.name)})},o=5,c=10,l={};l.colors=function(a,t){t=t||{};var l=t.exclude||[],i=t.paletteSize||c;n(a,function(n){for(var c=a.width*a.height||n.length,u={},s="",d=[],m={dominant:{name:"",count:0},palette:Array.apply(null,new Array(i)).map(Boolean).map(function(){return{name:"0,0,0",count:0}})},p=0;c>p;){if(d[0]=n[p],d[1]=n[p+1],d[2]=n[p+2],s=d.join(","),u[s]=s in u?u[s]+1:1,-1===l.indexOf(e(s))){var f=u[s];f>m.dominant.count?(m.dominant.name=s,m.dominant.count=f):m.palette.some(function(a){return f>a.count?(a.name=s,a.count=f,!0):void 0})}p+=4*o}if(t.success){var g=r(m.palette);t.success({dominant:e(m.dominant.name),secondary:g[0],palette:g})}})},a.RGBaster=a.RGBaster||l}(window),a.adaptiveBackground={run:function(c){var l=a.extend({},o,c);a(l.selector).each(function(){var o=a(this),c=function(){var a=i()?u():o[0];RGBaster.colors(a,{paletteSize:20,exclude:l.exclude,success:function(a){o.attr(t,a.dominant),o.trigger(r,{color:a.dominant,palette:a.palette})}})},i=function(){return o.attr(e)},u=function(){return o.css("background-image").replace("url(","").replace(")","").replace(" ","").replace(/\"/g,"")};o.on(r,function(a,t){var e;e=l.parent&&o.parents(l.parent).length?o.parents(l.parent):o.attr(n)&&o.parents(o.attr(n)).length?o.parents(o.attr(n)):i()?o:l.parent?o.parents(l.parent):o.parent(),e.css({backgroundColor:t.color});var r=function(){var a=t.color.match(/\d+/g);return(299*a[0]+587*a[1]+114*a[2])/1e3},c=function(a){return r(a)>=l.yiqThreshold?l.normalizedTextColors.dark:l.normalizedTextColors.light},u=function(a){return r(a)<=l.yiqThreshold?l.lumaClasses.dark:l.lumaClasses.light};l.normalizeTextColor&&e.css({color:c(t.color)}),e.addClass(u(t.color)).attr("data-ab-yaq",r(t.color)),l.success&&l.success(o,t)}),c()})}}}(jQuery);